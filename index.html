<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Comunica S√≠ndico - Cond√¥minos</title>

<style>
:root{
  --bg:#0b2b45;
  --card:#143d63;
  --radius:18px;
}

*{box-sizing:border-box}

html,body{
  margin:0;
  font-family:system-ui,-apple-system,Segoe UI,Roboto;
  background:linear-gradient(180deg,#5fa0d4,#9ec3df);
  color:#fff;
}

/* LAYOUT PRINCIPAL */
.wrapper{
  min-height:100vh;
  padding:14px;
  display:grid;
  grid-template-rows:auto 1fr auto;
  gap:12px;
}

/* HEADER */
.header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  background:#0f3558;
  padding:18px 22px;
  border-radius:22px;
}

.header-left{
  display:flex;
  align-items:center;
  gap:14px;
}

.header h1{
  margin:0;
  font-size:26px;
  font-weight:900;
}

/* NUVEM */
.cloud{
  width:38px;
  height:38px;
  animation:spin 20s linear infinite;
}
@keyframes spin{
  from{transform:rotate(0deg)}
  to{transform:rotate(360deg)}
}

.badge{
  background:#08263f;
  padding:8px 14px;
  border-radius:999px;
  font-weight:700;
}

/* MAIN */
.main{
  display:grid;
  grid-template-columns:1.3fr 1.7fr;
  gap:14px;
}

/* AVISOS */
.avisos{
  display:grid;
  grid-template-rows:repeat(3,1fr);
  gap:12px;
}

.aviso-card{
  padding:18px;
  border-radius:20px;
  display:flex;
  flex-direction:column;
  justify-content:space-between;
}

.prioridade-alta{
  background:#e53935;
}
.prioridade-media{
  background:#fbc02d;
  color:#000;
}
.prioridade-baixa{
  background:#43a047;
}

.aviso-header{
  font-size:20px;
  font-weight:900;
}

.aviso-body{
  font-size:18px;
  margin-top:8px;
}

.aviso-footer{
  margin-top:10px;
  font-size:13px;
  display:flex;
  gap:14px;
  flex-wrap:wrap;
}

/* DIREITA */
.right-col{
  display:grid;
  grid-template-rows:1.4fr auto 1fr;
  gap:12px;
}

.videoWrap{
  background:#000;
  border-radius:18px;
  overflow:hidden;
  position:relative;
}

video{
  width:100%;
  height:100%;
  object-fit:cover;
}

.video-desc{
  background:#123a5e;
  padding:10px 14px;
  border-radius:12px;
  font-size:14px;
}

.mensagens{
  background:#143d63;
  padding:12px;
  border-radius:18px;
  overflow:auto;
}

.mensagem-item{
  padding:6px;
  border-bottom:1px solid rgba(255,255,255,0.1);
  font-size:13px;
}

/* FOOTER */
.footer{
  background:#0f3558;
  padding:14px 20px;
  border-radius:20px;
  display:flex;
  flex-direction:column;
  gap:6px;
}

.footer-line{
  display:flex;
  justify-content:space-between;
  font-size:14px;
}

/* BARRA TEMP */
.temp-bar{
  height:6px;
  background:#08263f;
  border-radius:6px;
  overflow:hidden;
  margin-top:6px;
  position:relative;
}

.temp-fill{
  height:100%;
  width:0%;
  background:linear-gradient(90deg,#00c6ff,#ff9800,#e53935);
}

.temp-value{
  position:absolute;
  top:-22px;
  transform:translateX(-50%);
  background:#000;
  padding:2px 6px;
  border-radius:6px;
  font-size:11px;
}

@media(max-width:900px){
  .main{grid-template-columns:1fr}
}
</style>
</head>

<body>

<div class="wrapper">

<!-- HEADER -->
<div class="header">
  <div class="header-left">
    <h1>Comunica S√≠ndico - Cond√¥minos</h1>
    <svg class="cloud" viewBox="0 0 100 100">
      <ellipse cx="50" cy="55" rx="30" ry="18" fill="#fff"/>
      <ellipse cx="35" cy="45" rx="18" ry="14" fill="#fff"/>
      <ellipse cx="65" cy="45" rx="18" ry="14" fill="#fff"/>
    </svg>
  </div>
  <span class="badge" id="clock">--:--</span>
</div>

<!-- MAIN -->
<div class="main">

<div class="avisos" id="avisosContainer"></div>

<div class="right-col">

  <div class="videoWrap">
    <video id="adVideo" autoplay muted loop playsinline></video>
  </div>

  <div class="video-desc" id="videoDesc"></div>

  <div class="mensagens" id="mensagensContainer"></div>

</div>
</div>

<!-- FOOTER -->
<div class="footer">
  <div class="footer-line" id="versiculo"></div>

  <div class="footer-line">
    <div></div>
    <div>
      <div id="clima"></div>
      <div class="temp-bar">
        <div class="temp-fill" id="tempFill"></div>
        <div class="temp-value" id="tempValue">--¬∞C</div>
      </div>
    </div>
  </div>
</div>

</div>

<script>
/* REL√ìGIO */
function tick(){
  const d=new Date();
  document.getElementById("clock").textContent=
  d.toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"});
}
setInterval(tick,1000); tick();

/* CARREGAR DADOS */
async function loadData(){
  const r=await fetch("./data.json?ts="+Date.now());
  const d=await r.json();

  /* AVISOS */
  const avisos=d.avisos||[];
  const cont=document.getElementById("avisosContainer");
  cont.innerHTML="";
  avisos.slice(0,3).forEach(a=>{
    const div=document.createElement("div");
    div.className="aviso-card prioridade-"+a.prioridade.toLowerCase();
    div.innerHTML=`
      <div>
        <div class="aviso-header">${a.titulo}</div>
        <div class="aviso-body">${a.descricao}</div>
      </div>
      <div class="aviso-footer">
        <span>üìç ${a.local}</span>
        <span>‚ö° ${a.prioridade}</span>
      </div>
    `;
    cont.appendChild(div);
  });

  /* V√çDEO */
  if(d.publicidade?.videos?.length){
    const video=d.publicidade.videos[0];
    const v=document.getElementById("adVideo");
    v.src=video.arquivo;
    document.getElementById("videoDesc").textContent=video.anunciante;
  }

  /* MENSAGENS */
  const msgCont=document.getElementById("mensagensContainer");
  msgCont.innerHTML="";
  (d.mensagens||[]).forEach(m=>{
    const div=document.createElement("div");
    div.className="mensagem-item";
    div.textContent=m;
    msgCont.appendChild(div);
  });
}

/* CLIMA */
async function carregarClima(){
  const rJson=await fetch("./data.json?ts="+Date.now());
  const json=await rJson.json();

  const lat=json.clima.latitude;
  const lon=json.clima.longitude;
  const cidade=json.clima.cidade;

  const r=await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current_weather=true`);
  const d=await r.json();
  const temp=d.current_weather.temperature;

  document.getElementById("clima").textContent=
    `${cidade} ‚Ä¢ ${temp}¬∞C`;

  const percent=(temp/40)*100;
  document.getElementById("tempFill").style.width=percent+"%";
  document.getElementById("tempValue").style.left=percent+"%";
  document.getElementById("tempValue").textContent=temp+"¬∞C";
}

/* VERS√çCULO */
async function carregarVersiculo(){
  const r=await fetch("https://raw.githubusercontent.com/comunicasindico/comunica-sindico/main/versiculos.json");
  const dados=await r.json();
  const hoje=new Date();
  const chave=String(hoje.getMonth()+1).padStart(2,"0")+"-"+String(hoje.getDate()).padStart(2,"0");
  document.getElementById("versiculo").textContent=dados.versos[chave]||"";
}

loadData();
carregarClima();
carregarVersiculo();
setInterval(carregarClima,600000);
</script>

</body>
</html>

<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<title>Comunica S√≠ndico - Cond√¥minos</title>

<style>

/* =========================================================
   ITEM 001 ‚Äì VARI√ÅVEIS
   ========================================================= */
:root{
  --radius:18px;
}

/* =========================================================
   ITEM 002 ‚Äì BASE
   ========================================================= */
*{box-sizing:border-box}

html,body{
  margin:0;
  height:100%;
  font-family:system-ui,-apple-system,Segoe UI,Roboto;
  background:linear-gradient(180deg,#1e5799,#7db9e8);
  color:#fff;
}
body{
  overflow:hidden;
  display:flex;
  justify-content:center;
  align-items:flex-start;
}

/* =========================================================
   ITEM 003 ‚Äì WRAPPER ESCAL√ÅVEL
   ========================================================= */
.wrapper{
  width:1920px;   /* üî• base padr√£o FullHD */
  height:1080px;  /* üî• base padr√£o FullHD */
  padding:16px;
  display:grid;
  grid-template-rows:auto 1fr auto;
  gap:16px;
  transform-origin: top left;
}
   
/* =========================================================
   ITEM 004 ‚Äì HEADER (com √≠cone clima √† direita do t√≠tulo)
   ========================================================= */
.header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  background:#15385c;
  padding:16px 24px;
  border-radius:20px;
}

.header-left{
  display:flex;
  align-items:center;
  gap:14px;
}

.header h1{
  margin:0;
  font-size:24px;
  font-weight:900;
}

#weatherIcon{
  font-size:26px;
}

.badge{
  background:#0f2f4d;
  padding:8px 14px;
  border-radius:999px;
  font-weight:700;
}

/* =========================================================
   ITEM 005 ‚Äì GRID FIXO DESKTOP
   ========================================================= */
.main{
  display:grid;
  grid-template-columns:1.2fr 1.8fr;
  gap:16px;
  height:100%;
}

/* =========================================================
   ITEM 006 ‚Äì AVISOS COM PRIORIDADE VISUAL + TRANSI√á√ÉO
   ========================================================= */
.avisos{
  display:grid;
  grid-template-rows:repeat(3,1fr);
  gap:16px;
  height:100%;
}

.aviso-card{
  background:linear-gradient(145deg,#1b2e4a,#13263f);
  padding:18px 20px;
  border-radius:20px;
  display:flex;
  flex-direction:column;
  justify-content:space-between;
  box-shadow:0 8px 30px rgba(0,0,0,0.5);
  position:relative;
  border:4px solid transparent;
  transition:all .6s ease;
  opacity:0;
  transform:translateY(20px);
}

/* üî• anima√ß√£o entrada */
.aviso-card.show{
  opacity:1;
  transform:translateY(0);
}

/* ===== PRIORIDADE ALTA ===== */
.prioridade-alta{
  border:6px solid #ff2b2b;
  box-shadow:
    0 0 18px rgba(255,0,0,0.8),
    0 0 40px rgba(255,0,0,0.6),
    0 8px 30px rgba(0,0,0,0.6);
}

/* ===== PRIORIDADE M√âDIA ===== */
.prioridade-media{
  border:5px solid #ffc107;
  box-shadow:
    0 0 14px rgba(255,193,7,0.7),
    0 8px 30px rgba(0,0,0,0.6);
}

/* ===== PRIORIDADE BAIXA ===== */
.prioridade-baixa{
  border:5px solid #4caf50;
  box-shadow:
    0 0 14px rgba(76,175,80,0.7),
    0 8px 30px rgba(0,0,0,0.6);
}

/* T√çTULO */
.aviso-header{
  font-weight:900;
  font-size:16px;
  text-align:left;
}

/* TEXTO CENTRAL */
.aviso-body{
  flex:1;
  display:flex;
  align-items:center;
  justify-content:center;
  text-align:center;
  font-size:clamp(22px,2.2vw,32px);
  line-height:1.3;
  padding:6px 0;
}

/* RODAP√â */
.aviso-footer{
  display:flex;
  justify-content:flex-start;
  gap:12px;
  font-size:12px;
  opacity:.95;
  flex-wrap:wrap;
}

.badge-prioridade{
  padding:4px 10px;
  border-radius:999px;
  font-size:11px;
  font-weight:800;
}

/* =========================================================
   ITEM 007 ‚Äì COLUNA DIREITA
   ========================================================= */
.right-col{
  display:grid;
  grid-template-rows:1fr auto auto;
  gap:16px;
  height:100%;
}

/* =========================================================
   ITEM 008 ‚Äì V√çDEO COM FUNDO FOSCO
   ========================================================= */
.videoWrap{
  position:relative;
  border-radius:20px;
  overflow:hidden;
}

#adVideoBg{
  position:absolute;
  inset:0;
  width:100%;
  height:100%;
  object-fit:cover;
  filter:blur(40px);
  transform:scale(1.2);
  opacity:.7;
}

#adVideo{
  position:absolute;
  inset:0;
  width:100%;
  height:100%;
  object-fit:contain;
}

/* =========================================================
   ITEM 009 ‚Äì DESCRI√á√ÉO
   ========================================================= */
.videoDescricao{
  background:#14324f;
  padding:14px;
  border-radius:16px;
  text-align:center;
}

/* =========================================================
   ITEM 010 ‚Äì MENSAGENS
   ========================================================= */
.mensagens{
  background:#14324f;
  padding:14px;
  border-radius:16px;
  font-size:14px;
  overflow:auto;
}

/* =========================================================
   ITEM 011 ‚Äì RODAP√â DEFINITIVO
   ========================================================= */
.footer{
  background:#15385c;
  padding:18px 28px;
  border-radius:20px;
  display:flex;
  flex-direction:column;
  justify-content:center;
  gap:6px;
  min-height:70px;
}

.footer-linha1{
  display:flex;
  justify-content:flex-start;
  font-weight:700;
  font-size:16px;
  line-height:1.3;
  word-break:break-word;
}

.footer-linha2{
  display:flex;
  justify-content:flex-end;
  gap:14px;
  font-size:14px;
  align-items:center;
  opacity:.95;
}

/* =========================================================
   ITEM 012 ‚Äì MOBILE
   ========================================================= */
@media (max-width:768px){
  body{ overflow:auto; }
  .main{ grid-template-columns:1fr; }
}

</style>
</head>

<body>

<div class="wrapper">

<!-- HEADER -->
<div class="header">
  <div class="header-left">
    <h1>Comunica S√≠ndico - Cond√¥minos</h1>
    <span id="weatherIcon">‚òÅÔ∏è</span>
  </div>
  <span class="badge" id="clock">--:--</span>
</div>

<!-- MAIN -->
<div class="main">

  <div class="avisos" id="avisosContainer"></div>

  <div class="right-col">

    <div class="videoWrap">
      <video id="adVideoBg" autoplay muted loop playsinline></video>
      <video id="adVideo" autoplay muted loop playsinline></video>
    </div>

    <div class="videoDescricao" id="videoDescricao"></div>
    <div class="mensagens" id="mensagensContainer"></div>

  </div>
</div>

<!-- FOOTER -->
<div class="footer">
  <div class="footer-linha1" id="versiculo"></div>
  <div class="footer-linha2">
    <span id="cidade"></span>
    <span id="temperatura"></span>
    <span id="vento"></span>
  </div>
</div>

</div>

<script>

/* REL√ìGIO */
function tick(){
  const d=new Date();
  document.getElementById("clock").textContent=
    d.toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"});
}
setInterval(tick,1000); tick();

/* LIMITADOR 200 */
function limitarTexto(texto){
  if(!texto) return "";
  if(texto.length<=200) return texto;
  return texto.substring(0,200)+"...";
}

/* =========================================================
   ITEM 019 ‚Äì AVISOS COM PRIORIDADE + TRANSI√á√ÉO
   ========================================================= */

let avisosGlobais=[];
let avisoIndex=0;

function renderAvisos(){

  const container=document.getElementById("avisosContainer");

  /* üî• fade out suave */
  container.style.opacity="0";

  setTimeout(()=>{

    container.innerHTML="";

    for(let i=0;i<3;i++){

      if(!avisosGlobais.length) return;

      const a=avisosGlobais[(avisoIndex+i)%avisosGlobais.length];

      const prioridade=(a.prioridade||"media")
        .toLowerCase()
        .normalize("NFD")
        .replace(/[\u0300-\u036f]/g,"");

      const div=document.createElement("div");
      div.className=`aviso-card prioridade-${prioridade}`;

      div.innerHTML=`
        <div class="aviso-header">
          ${a.titulo||""}
        </div>

        <div class="aviso-body">
          ${limitarTexto(a.descricao||"")}
        </div>

        <div class="aviso-footer">
          <span>üìç ${a.local||""}</span>
          <span>üè∑ ${a.tipo||""}</span>
          <span class="badge-prioridade">
            ${(a.prioridade||"").toUpperCase()}
          </span>
        </div>
      `;

      container.appendChild(div);

      /* üî• anima√ß√£o individual */
      setTimeout(()=>{
        div.classList.add("show");
      },100);
    }

    avisoIndex=(avisoIndex+1)%avisosGlobais.length;

    container.style.opacity="1";

  },300);
}


/* item 020 V√çDEO */
let videosGlobais=[];
let videoIndex=0;

function trocarVideo(){
  if(!videosGlobais.length) return;

  const v=videosGlobais[videoIndex];
  const video=document.getElementById("adVideo");
  const bg=document.getElementById("adVideoBg");

  video.src=v.arquivo+"?ts="+Date.now();
  bg.src=v.arquivo+"?ts="+Date.now();

  video.load();
  bg.load();

  video.play().catch(()=>{});
  bg.play().catch(()=>{});

  document.getElementById("videoDescricao").innerHTML=
    `<strong>${v.anunciante||""}</strong><br>${v.descricao||""}`;

  video.onended=function(){
    videoIndex=(videoIndex+1)%videosGlobais.length;
    trocarVideo();
  };
}

/* CLIMA + √çCONE */
async function carregarClima(){
  const r=await fetch("./data.json?ts="+Date.now());
  const json=await r.json();

  const cidade=json.clima?.cidade||"Tubar√£o";
  const lat=json.clima?.latitude;
  const lon=json.clima?.longitude;

  const r2=await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current_weather=true`);
  const d=await r2.json();
  const w=d.current_weather;

  document.getElementById("cidade").textContent=cidade;
  document.getElementById("temperatura").textContent=w.temperature+"¬∞C";
  document.getElementById("vento").textContent="üå¨ "+w.windspeed+" km/h";

  const code=w.weathercode;
  const iconMap={
    0:"‚òÄÔ∏è",1:"üå§",2:"‚õÖ",3:"‚òÅÔ∏è",
    61:"üåß",71:"‚ùÑÔ∏è",95:"‚õà"
  };
  document.getElementById("weatherIcon").textContent=iconMap[code]||"‚òÅÔ∏è";
}

/* LOAD */
async function loadData(){
  const r=await fetch("./data.json?ts="+Date.now());
  const d=await r.json();

  avisosGlobais=d.avisos||[];
  videosGlobais=d.publicidade?.videos||[];

  renderAvisos();
  trocarVideo();
}

   /* =========================================================
   ITEM 022 ‚Äì CARREGAR VERS√çCULO
   ========================================================= */
async function carregarVersiculo(){
  try{

    const r = await fetch(
      "https://raw.githubusercontent.com/comunicasindico/comunica-sindico/main/versiculos.json?ts=" + Date.now()
    );

    const dados = await r.json();

    const hoje = new Date();
    const chave =
      String(hoje.getMonth()+1).padStart(2,"0") +
      "-" +
      String(hoje.getDate()).padStart(2,"0");

    const versiculo = dados.versos?.[chave] || "Voc√™ tem valor diante de Deus.";

    const el = document.getElementById("versiculo");

    if(el){
      el.textContent = versiculo;
    }

  }catch(e){
    console.error("Erro vers√≠culo:", e);
  }
}

   /* =========================================================
   ITEM 023 ‚Äì INICIALIZA√á√ÉO DO VERS√çCULO
   ========================================================= */
carregarVersiculo();
setInterval(carregarVersiculo,3600000);

loadData();
carregarClima();
setInterval(renderAvisos,8000);
setInterval(loadData,60000);
setInterval(carregarClima,600000);

   /* =========================================================
   ITEM 024 ‚Äì ESCALA AUTOM√ÅTICA DO PAINEL
   ========================================================= */
function ajustarEscala(){

  const baseWidth  = 1920;
  const baseHeight = 1080;

  const scaleX = window.innerWidth  / baseWidth;
  const scaleY = window.innerHeight / baseHeight;

  const escala = Math.min(scaleX, scaleY);

  const wrapper = document.querySelector(".wrapper");

  wrapper.style.transform = `scale(${escala})`;
}
window.addEventListener("resize", ajustarEscala);
window.addEventListener("load", ajustarEscala);

</script>

</body>
</html>

<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<title>Comunica S√≠ndico - Cond√¥minos</title>

<style>

/* =========================================================
   ITEM 001 ‚Äì VARI√ÅVEIS
   ========================================================= */
:root{
  --radius:18px;
}

/* =========================================================
   ITEM 002 ‚Äì BASE FLUIDA RESPONSIVA TOTAL
   ========================================================= */
html, body{
  margin:0;
  padding:0;
  width:100%;
  height:100%;
  overflow:hidden;
  background:linear-gradient(180deg,#1e5799,#7db9e8);
  font-family:system-ui,-apple-system,Segoe UI,Roboto;
  color:#ffffff;

  font-size:clamp(12px, 1vw, 22px); /* üî• escala base autom√°tica */
}

/* =========================================================
   ITEM 003 ‚Äì WRAPPER TOTALMENTE FLUIDO
   ========================================================= */
.wrapper{
  width:100%;
  height:100%;
  padding:1.2vw;
  box-sizing:border-box;

  display:grid;
  grid-template-rows:auto 1fr auto;
  gap:1.2vw;
}
/* =========================================================
   ITEM 004 ‚Äì HEADER (com √≠cone clima √† direita do t√≠tulo)
   ========================================================= */
.header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  background:#15385c;
  padding:1vw 1.5vw;
  border-radius:1.2vw;
}

.header-left{
  display:flex;
  align-items:center;
  gap:14px;
}

.header h1{
  margin:0;
  font-size:clamp(14px, 1.6vw, 28px);
  font-weight:900;
}

#weatherIcon{
  font-size:26px;
}

.badge{
  background:#0f2f4d;
  padding:8px 14px;
  border-radius:999px;
  font-weight:700;
}

/* =========================================================
   ITEM 005 ‚Äì GRID FIXO DESKTOP
   ========================================================= */
.main{
  display:grid;
  grid-template-columns:1.2fr 1.8fr;
  gap:16px;
  height:100%;
}

/* =========================================================
   ITEM 006 ‚Äì AVISOS COM PRIORIDADE VISUAL + TRANSI√á√ÉO
   ========================================================= */
.avisos{
  display:grid;
  grid-template-rows:repeat(3,1fr);
  gap:16px;
  height:100%;
}

.aviso-card{
  background:linear-gradient(145deg,#1b2e4a,#13263f);
  padding:18px 20px;
  border-radius:20px;
  display:flex;
  flex-direction:column;
  justify-content:space-between;
  box-shadow:0 8px 30px rgba(0,0,0,0.5);
  position:relative;
  border:4px solid transparent;
  transition:all .6s ease;
  opacity:0;
  transform:translateY(20px);
}

/* üî• anima√ß√£o entrada */
.aviso-card.show{
  opacity:1;
  transform:translateY(0);
}

/* ===== PRIORIDADE ALTA ===== */
.prioridade-alta{
  border:6px solid #ff2b2b;
  box-shadow:
    0 0 18px rgba(255,0,0,0.8),
    0 0 40px rgba(255,0,0,0.6),
    0 8px 30px rgba(0,0,0,0.6);
}

/* ===== PRIORIDADE M√âDIA ===== */
.prioridade-media{
  border:5px solid #ffc107;
  box-shadow:
    0 0 14px rgba(255,193,7,0.7),
    0 8px 30px rgba(0,0,0,0.6);
}

/* ===== PRIORIDADE BAIXA ===== */
.prioridade-baixa{
  border:5px solid #4caf50;
  box-shadow:
    0 0 14px rgba(76,175,80,0.7),
    0 8px 30px rgba(0,0,0,0.6);
}

/* T√çTULO */
.aviso-header{
  font-weight:900;
  font-size:16px;
  text-align:left;
  color:#ffffff;
}

.aviso-body{
  flex:1;
  display:flex;
  align-items:center;
  justify-content:center;
  text-align:center;
  font-size:clamp(14px, 1.4vw, 26px);
  line-height:1.3;
}

/* RODAP√â */
.aviso-footer{
  display:flex;
  justify-content:flex-start;
  gap:12px;
  font-size:12px;
  opacity:.95;
  flex-wrap:wrap;
  color:#ffffff;
}

.badge-prioridade{
  padding:4px 10px;
  border-radius:999px;
  font-size:11px;
  font-weight:800;
}

/* =========================================================
   ITEM 007 ‚Äì COLUNA DIREITA
   ========================================================= */
.right-col{
  display:grid;
  grid-template-rows:1fr auto auto;
  gap:16px;
  height:100%;
}

/* =========================================================
   ITEM 008 ‚Äì TV LED INTELIGENTE DIN√ÇMICA
   ========================================================= */
.videoWrap{
  position:relative;
  border-radius:28px;
  padding:1.4%;
  background:#000;
  box-shadow:
    0 0 0 4px #000,
    0 25px 60px rgba(0,0,0,.85),
    inset 0 0 40px rgba(255,255,255,.04);
  overflow:hidden;
}

/* Reflexo superior */
.videoWrap::before{
  content:"";
  position:absolute;
  top:0;
  left:0;
  right:0;
  height:30%;
  border-radius:28px;
  background:linear-gradient(to bottom,
    rgba(255,255,255,.08),
    transparent);
  pointer-events:none;
}

/* üî¥üîµüü¢ LED din√¢mico */
.videoWrap::after{
  content:"";
  position:absolute;
  bottom:6px;
  left:50%;
  transform:translateX(-50%);
  width:90px;
  height:6px;
  border-radius:20px;
  background:var(--led-color, #00aaff);
  box-shadow:
    0 0 12px var(--led-color, #00aaff),
    0 0 28px var(--led-color, #00aaff),
    0 0 55px rgba(0,0,0,.4);
  animation:ledPulse 2.2s infinite ease-in-out;
}

@keyframes ledPulse{
  0%{ opacity:.6; }
  50%{ opacity:1; }
  100%{ opacity:.6; }
}

/* üé¨ Fundo fosco preto usando o pr√≥prio v√≠deo */
#adVideoBg{
  position:absolute;
  inset:2%;
  width:96%;
  height:96%;
  object-fit:cover;
  filter:blur(35px) brightness(.35);
  transform:scale(1.3);
  border-radius:18px;
}

/* Tela principal */
#adVideo{
  position:absolute;
  inset:2%;
  width:96%;
  height:96%;
  object-fit:contain;
  border-radius:18px;
  background:#000;
}

/* =========================================================
   ITEM 009 ‚Äì DESCRI√á√ÉO
   ========================================================= */
.videoDescricao{
  background:#14324f;
  padding:14px;
  border-radius:16px;
  text-align:center;
}

/* =========================================================
   ITEM 010 ‚Äì MENSAGENS
   ========================================================= */
.mensagens{
  background:#14324f;
  padding:14px;
  border-radius:16px;
  font-size:14px;
  overflow:auto;
}

/* =========================================================
   ITEM 011 ‚Äì RODAP√â PREMIUM CLIMA INTELIGENTE
   ========================================================= */

.footer{
  background:#15385c;
  padding:clamp(8px, 1.2vh, 24px);
  border-radius:clamp(8px, 1.2vw, 20px);

  display:flex;
  flex-direction:column;
  justify-content:center;
  gap:clamp(4px, .8vh, 12px);
}

.footer-linha1{
  font-size:clamp(12px, 1.4vh, 26px);
  font-weight:600;
}

.footer-linha2{
  font-size:clamp(11px, 1.2vh, 22px);
  display:flex;
  justify-content:flex-end;
  gap:clamp(8px, 1vw, 18px);
  align-items:center;
}

/* üå° Sensa√ß√£o t√©rmica */
.sensacao{
  font-weight:700;
  transition:all .4s ease;
}

/* üî• alerta calor */
.sensacao.calor{
  color:#ffb347;
  text-shadow:0 0 8px rgba(255,150,0,.6);
}

/* ‚ùÑ alerta frio */
.sensacao.frio{
  color:#6ecbff;
  text-shadow:0 0 8px rgba(100,200,255,.6);
}

/* üîÑ anima√ß√£o leve */
.clima-update{
  animation:climaFade .6s ease;
}

@keyframes climaFade{
  from{ opacity:.3; transform:translateY(3px); }
  to{ opacity:1; transform:translateY(0); }
}

/* =========================================================
   ITEM 012 ‚Äì MOBILE
   ========================================================= */
@media (max-width:768px){
  body{ overflow:auto; }
  .main{ grid-template-columns:1fr; }
}

</style>
</head>

<body>

<div class="wrapper">


   
<!-- HEADER -->
<div class="header">
  <div class="header-left">
    <h1>Comunica S√≠ndico - Cond√¥minos</h1>
    <span id="weatherIcon">‚òÅÔ∏è</span>
  </div>
  <span class="badge" id="clock">--:--</span>
</div>


   
   <!-- MAIN -->
<div class="main">

  <div class="avisos" id="avisosContainer"></div>

  <div class="right-col">

    <div class="videoWrap">
      <video id="adVideoBg" autoplay muted loop playsinline></video>
      <video id="adVideo" autoplay muted loop playsinline></video>
    </div>

    <div class="videoDescricao" id="videoDescricao"></div>
    <div class="mensagens" id="mensagensContainer"></div>

  </div>
</div>


   
   <!-- FOOTER -->
<div class="footer">
  <div class="footer-linha1" id="versiculo"></div>
 
   <div class="footer-linha2">
  <span id="cidade"></span>
  <span id="temperatura"></span>
  <span id="sensacao" class="sensacao"></span>
  <span id="vento"></span>
</div>
</div>

</div>

<script>


   
/* REL√ìGIO */
function tick(){
  const d=new Date();
  document.getElementById("clock").textContent=
    d.toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"});
}
setInterval(tick,1000); tick();


   
/* LIMITADOR 200 */
function limitarTexto(texto){
  if(!texto) return "";
  if(texto.length<=200) return texto;
  return texto.substring(0,200)+"...";
}

/* =========================================================
   ITEM 019 ‚Äì AVISOS COM PRIORIDADE + TRANSI√á√ÉO
   ========================================================= */

let avisosGlobais=[];
let avisoIndex=0;

function renderAvisos(){

  const container=document.getElementById("avisosContainer");

  /* üî• fade out suave */
  container.style.opacity="0";

  setTimeout(()=>{

    container.innerHTML="";

    for(let i=0;i<3;i++){

      if(!avisosGlobais.length) return;

      const a=avisosGlobais[(avisoIndex+i)%avisosGlobais.length];

      const prioridade=(a.prioridade||"media")
        .toLowerCase()
        .normalize("NFD")
        .replace(/[\u0300-\u036f]/g,"");

      const div=document.createElement("div");
      div.className=`aviso-card prioridade-${prioridade}`;

      div.innerHTML=`
        <div class="aviso-header">
          ${a.titulo||""}
        </div>

        <div class="aviso-body">
          ${limitarTexto(a.descricao||"")}
        </div>

        <div class="aviso-footer">
          <span>üìç ${a.local||""}</span>
          <span>üè∑ ${a.tipo||""}</span>
          <span class="badge-prioridade">
            ${(a.prioridade||"").toUpperCase()}
          </span>
        </div>
      `;

      container.appendChild(div);

      /* üî• anima√ß√£o individual */
      setTimeout(()=>{
        div.classList.add("show");
      },100);
    }

    avisoIndex=(avisoIndex+1)%avisosGlobais.length;

    container.style.opacity="1";

  },300);
}

/* =========================================================
   ITEM 020 ‚Äì CLIMA PREMIUM COM SENSA√á√ÉO INTELIGENTE
   ========================================================= */

function atualizarClima(dados){

  const temp      = Math.round(dados.main.temp);
  const sensacao  = Math.round(dados.main.feels_like);
  const vento     = Math.round(dados.wind.speed);

  const tempEl     = document.getElementById("temperatura");
  const sensacaoEl = document.getElementById("sensacao");
  const ventoEl    = document.getElementById("vento");

  tempEl.textContent = `${temp}¬∞C`;
  ventoEl.textContent = `üå¨ ${vento} km/h`;

  /* üå° √çcone t√©rmico + texto */
  sensacaoEl.textContent = `üå° Sensa√ß√£o ${sensacao}¬∞C`;

  /* Remove classes anteriores */
  sensacaoEl.classList.remove("calor","frio");

  /* üî• Alerta calor */
  if(sensacao > temp){
    sensacaoEl.classList.add("calor");
  }

  /* ‚ùÑ Alerta frio */
  if(sensacao < temp){
    sensacaoEl.classList.add("frio");
  }

  /* üîÑ anima√ß√£o leve */
  sensacaoEl.classList.add("clima-update");
  tempEl.classList.add("clima-update");

  setTimeout(()=>{
    sensacaoEl.classList.remove("clima-update");
    tempEl.classList.remove("clima-update");
  },600);
}

/* =========================================================
   ITEM 021  V√çDEO 
   ========================================================= */
let videosGlobais=[];
let videoIndex=0;

function trocarVideo(){
  if(!videosGlobais.length) return;

  const v=videosGlobais[videoIndex];
  const video=document.getElementById("adVideo");
  const bg=document.getElementById("adVideoBg");

  video.src=v.arquivo+"?ts="+Date.now();
  bg.src=v.arquivo+"?ts="+Date.now();

  video.load();
  bg.load();

  video.play().catch(()=>{});
  bg.play().catch(()=>{});

  document.getElementById("videoDescricao").innerHTML=
    `<strong>${v.anunciante||""}</strong><br>${v.descricao||""}`;
/* üîµ LED DIN√ÇMICO AUTOM√ÅTICO */
const nome = (v.anunciante || "").toLowerCase();

let cor = "#00aaff"; // azul padr√£o

if(nome.includes("calibra")){
  cor = "#00ff88"; // verde
}
else if(nome.includes("newpet")){
  cor = "#ff2b2b"; // vermelho
}
else if(nome.includes("farmacia")){
  cor = "#ffd700"; // dourado
}
else{
  cor = "#00aaff"; // azul institucional padr√£o
}
document.querySelector(".videoWrap")
  .style.setProperty("--led-color", cor);

  video.onended=function(){
    videoIndex=(videoIndex+1)%videosGlobais.length;
    trocarVideo();
  };
}

/* =========================================================
   ITEM 020 ‚Äì CLIMA FINAL CORRIGIDO
   ========================================================= */

async function carregarClima(){

  try{

    const rJson = await fetch("./data.json?ts=" + Date.now());
    const json  = await rJson.json();

    const cidade = json.clima?.cidade || "Tubar√£o";
    const lat    = json.clima?.latitude;
    const lon    = json.clima?.longitude;

    const r = await fetch(
      `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current_weather=true`
    );

    const d = await r.json();
    const w = d.current_weather;

    const temp  = Math.round(w.temperature);
    const vento = Math.round(w.windspeed);

    /* C√°lculo sensa√ß√£o t√©rmica */
    const sensacao = Math.round(
      13.12 + 0.6215*temp - 11.37*Math.pow(vento,0.16) +
      0.3965*temp*Math.pow(vento,0.16)
    );

    const cidadeEl    = document.getElementById("cidade");
    const tempEl      = document.getElementById("temperatura");
    const sensacaoEl  = document.getElementById("sensacao");
    const ventoEl     = document.getElementById("vento");

    cidadeEl.textContent = cidade;
    tempEl.textContent   = `${temp}¬∞C`;
    ventoEl.textContent  = `üå¨ ${vento} km/h`;

    /* üî• Corrige √≠cone t√©rmico correto */
    sensacaoEl.textContent = `üå° Sensa√ß√£o ${sensacao}¬∞C`;

    sensacaoEl.classList.remove("calor","frio");

    if(sensacao > temp){
      sensacaoEl.classList.add("calor");
    }

    if(sensacao < temp){
      sensacaoEl.classList.add("frio");
    }

    /* anima√ß√£o */
    sensacaoEl.classList.remove("clima-update");
    void sensacaoEl.offsetWidth;
    sensacaoEl.classList.add("clima-update");

  }catch(e){
    console.error("Erro clima:", e);
  }
}



/* LOAD */
async function loadData(){
  const r=await fetch("./data.json?ts="+Date.now());
  const d=await r.json();

  avisosGlobais=d.avisos||[];
  videosGlobais=d.publicidade?.videos||[];

  renderAvisos();
  trocarVideo();
}

   /* =========================================================
   ITEM 022 ‚Äì CARREGAR VERS√çCULO
   ========================================================= */
async function carregarVersiculo(){
  try{

    const r = await fetch(
      "https://raw.githubusercontent.com/comunicasindico/comunica-sindico/main/versiculos.json?ts=" + Date.now()
    );

    const dados = await r.json();

    const hoje = new Date();
    const chave =
      String(hoje.getMonth()+1).padStart(2,"0") +
      "-" +
      String(hoje.getDate()).padStart(2,"0");

    const versiculo = dados.versos?.[chave] || "Voc√™ tem valor diante de Deus.";

    const el = document.getElementById("versiculo");

    if(el){
      el.textContent = versiculo;
    }

  }catch(e){
    console.error("Erro vers√≠culo:", e);
  }
}

   /* =========================================================
   ITEM 023 ‚Äì INICIALIZA√á√ÉO DO VERS√çCULO
   ========================================================= */
carregarVersiculo();
setInterval(carregarVersiculo,3600000);

loadData();
carregarClima();
setInterval(renderAvisos,8000);
setInterval(loadData,60000);
setInterval(carregarClima,600000);



   
</script>

</body>
</html>

<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Comunica S√≠ndico - Cond√¥minos</title>

<style>

/* =========================================================
   ITEM 001 ‚Äì BASE
   ========================================================= */
html,body{
  margin:0;
  padding:0;
  width:100%;
  height:100%;
  overflow:hidden;
  background:linear-gradient(180deg,#1e5799,#7db9e8);
  font-family:system-ui,-apple-system,Segoe UI,Roboto;
  color:#fff;
  font-size:clamp(12px,1vw,22px);
}

.wrapper{
  width:100%;
  height:100%;
  padding:1.2vw;
  box-sizing:border-box;
  display:grid;
  grid-template-rows:auto 1fr auto;
  gap:1.2vw;
}

/* =========================================================
   ITEM 002 ‚Äì HEADER
   ========================================================= */
.header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  background:#15385c;
  padding:1vw 1.5vw;
  border-radius:18px;
}

.header h1{
  margin:0;
  font-size:clamp(14px,1.6vw,28px);
  font-weight:900;
}

.badge{
  background:#0f2f4d;
  padding:8px 14px;
  border-radius:999px;
  font-weight:700;
}

/* =========================================================
   ITEM 003 ‚Äì GRID PRINCIPAL
   ========================================================= */
.main{
  display:grid;
  grid-template-columns:1.2fr 1.8fr;
  gap:16px;
  height:100%;
}

/* =========================================================
   ITEM 004 ‚Äì AVISOS
   ========================================================= */
.avisos{
  display:grid;
  grid-template-rows:repeat(3,1fr);
  gap:16px;
}

.aviso-card{
  background:linear-gradient(145deg,#1b2e4a,#13263f);
  padding:18px;
  border-radius:20px;
  display:flex;
  flex-direction:column;
  justify-content:space-between;
  border:4px solid transparent;
  box-shadow:0 8px 30px rgba(0,0,0,.5);
  transition:.5s;
  opacity:0;
  transform:translateY(15px);
}

.aviso-card.show{
  opacity:1;
  transform:translateY(0);
}

.prioridade-alta{
  border:6px solid #ff2b2b;
  box-shadow:0 0 20px rgba(255,0,0,.8);
}

.prioridade-media{
  border:5px solid #ffc107;
}

.prioridade-baixa{
  border:5px solid #4caf50;
}

.aviso-header{ font-weight:900; }
.aviso-body{
  flex:1;
  display:flex;
  align-items:center;
  justify-content:center;
  text-align:center;
  font-size:clamp(14px,1.4vw,26px);
}

/* =========================================================
   ITEM 005 ‚Äì COLUNA DIREITA
   ========================================================= */
.right-col{
  display:grid;
  grid-template-rows:1fr auto auto;
  gap:16px;
}

/* =========================================================
   ITEM 006 ‚Äì V√çDEO
   ========================================================= */
.videoWrap{
  position:relative;
  border-radius:20px;
  overflow:hidden;
}

#adVideoBg{
  position:absolute;
  inset:0;
  width:100%;
  height:100%;
  object-fit:cover;
  filter:blur(40px);
  transform:scale(1.2);
  opacity:.6;
}

#adVideo{
  position:absolute;
  inset:0;
  width:100%;
  height:100%;
  object-fit:contain;
}

.videoDescricao,
.mensagens{
  background:#14324f;
  padding:14px;
  border-radius:16px;
}

/* =========================================================
   ITEM 007 ‚Äì FOOTER
   ========================================================= */
.footer{
  background:#15385c;
  padding:12px;
  border-radius:18px;
  display:flex;
  flex-direction:column;
  gap:6px;
}

.footer-linha2{
  display:flex;
  justify-content:flex-end;
  gap:14px;
}

.sensacao.calor{ color:#ffb347; }
.sensacao.frio{ color:#6ecbff; }

@media(max-width:768px){
  body{overflow:auto;}
  .main{grid-template-columns:1fr;}
}

</style>
</head>

<body>

<div class="wrapper">

<div class="header">
  <h1>Comunica S√≠ndico - Cond√¥minos</h1>
  <span class="badge" id="clock">--:--</span>
</div>

<div class="main">

  <div class="avisos" id="avisosContainer"></div>

  <div class="right-col">
    <div class="videoWrap">
      <video id="adVideoBg" autoplay muted loop playsinline></video>
      <video id="adVideo" autoplay muted loop playsinline></video>
    </div>

    <div class="videoDescricao" id="videoDescricao"></div>
    <div class="mensagens" id="mensagensContainer"></div>
  </div>

</div>

<div class="footer">
  <div id="versiculo"></div>
  <div class="footer-linha2">
    <span id="cidade"></span>
    <span id="temperatura"></span>
    <span id="sensacao" class="sensacao"></span>
    <span id="vento"></span>
  </div>
</div>

</div>

<script>

/* REL√ìGIO */
function tick(){
  const d=new Date();
  document.getElementById("clock").textContent=
    d.toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"});
}
setInterval(tick,1000); tick();

/* LIMITADOR */
function limitarTexto(t){
  if(!t) return "";
  return t.length>200 ? t.substring(0,200)+"..." : t;
}

/* AVISOS */
let avisosGlobais=[];
let avisoIndex=0;

function renderAvisos(){
  const container=document.getElementById("avisosContainer");
  container.innerHTML="";
  for(let i=0;i<3;i++){
    if(!avisosGlobais.length) return;
    const a=avisosGlobais[(avisoIndex+i)%avisosGlobais.length];
    const div=document.createElement("div");
    div.className="aviso-card prioridade-"+(a.prioridade||"media");
    div.innerHTML=`
      <div class="aviso-header">${a.titulo||""}</div>
      <div class="aviso-body">${limitarTexto(a.descricao||"")}</div>
    `;
    container.appendChild(div);
    setTimeout(()=>div.classList.add("show"),100);
  }
  avisoIndex=(avisoIndex+1)%avisosGlobais.length;
}

/* V√çDEO */
let videosGlobais=[];
let videoIndex=0;

function trocarVideo(){
  if(!videosGlobais.length) return;
  const v=videosGlobais[videoIndex];
  const video=document.getElementById("adVideo");
  const bg=document.getElementById("adVideoBg");
  video.src=v.arquivo;
  bg.src=v.arquivo;
  video.load();
  bg.load();
  videoIndex=(videoIndex+1)%videosGlobais.length;
}

/* CLIMA */
async function carregarClima(){
  try{
    const r=await fetch("./data.json");
    const j=await r.json();
    const cidade=j.clima?.cidade||"Tubar√£o";
    const lat=j.clima?.latitude;
    const lon=j.clima?.longitude;

    const r2=await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current_weather=true`);
    const d=await r2.json();
    const w=d.current_weather;

    const temp=Math.round(w.temperature);
    const vento=Math.round(w.windspeed);

    document.getElementById("cidade").textContent=cidade;
    document.getElementById("temperatura").textContent=`${temp}¬∞C`;
    document.getElementById("vento").textContent=`üå¨ ${vento} km/h`;

  }catch(e){ console.log(e); }
}

/* VERS√çCULO */
async function carregarVersiculo(){
  try{
    const r=await fetch("https://raw.githubusercontent.com/comunicasindico/comunica-sindico/main/versiculos.json");
    const dados=await r.json();
    const hoje=new Date();
    const chave=
      String(hoje.getMonth()+1).padStart(2,"0")+"-"+
      String(hoje.getDate()).padStart(2,"0");
    document.getElementById("versiculo").textContent=
      dados.versos?.[chave]||"Voc√™ tem valor diante de Deus.";
  }catch(e){ console.log(e); }
}

/* LOAD */
async function loadData(){
  const r=await fetch("./data.json");
  const d=await r.json();
  avisosGlobais=d.avisos||[];
  videosGlobais=d.publicidade?.videos||[];
  renderAvisos();
  trocarVideo();
}

loadData();
carregarClima();
carregarVersiculo();
setInterval(renderAvisos,8000);
setInterval(loadData,60000);
setInterval(carregarClima,600000);

</script>
</body>
</html>

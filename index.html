<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Comunica Síndico - Condôminos</title>

<style>
:root{
  --bg:#061726;
  --card:#0e2d4a;
  --radius:18px;
}

*{box-sizing:border-box}

html,body{
  margin:0;
  min-height:100vh;
  font-family:system-ui,-apple-system,Segoe UI,Roboto;
  background:var(--bg);
  color:#fff;
}

/* CAMADA DE EFEITOS */
#weatherEffects{
  position:fixed;
  inset:0;
  pointer-events:none;
  z-index:0;
}

/* ===== FUNDO DINÂMICO ===== */

body.clima-sol{ background:linear-gradient(180deg,#64b5f6,#bbdefb); }
body.clima-parcial{ background:linear-gradient(180deg,#4fc3f7,#81d4fa); }
body.clima-nublado{ background:linear-gradient(180deg,#78909c,#b0bec5); }
body.clima-chuva{ background:linear-gradient(180deg,#1e3c72,#2a5298); }
body.clima-tempestade{ background:linear-gradient(180deg,#232526,#414345); }
body.clima-noite{ background:linear-gradient(180deg,#0f2027,#203a43,#2c5364); }

/* CHUVA */
.rain{
  background-image:repeating-linear-gradient(
    to bottom,
    rgba(255,255,255,0.35) 0px,
    rgba(255,255,255,0.35) 2px,
    transparent 2px,
    transparent 8px
  );
  animation:rainFall .6s linear infinite;
}
@keyframes rainFall{
  from{background-position:0 0;}
  to{background-position:0 25px;}
}

/* ESTRELAS */
.stars{
  background:radial-gradient(white 1px, transparent 1px);
  background-size:40px 40px;
  animation:twinkle 3s infinite alternate;
}
@keyframes twinkle{
  from{opacity:0.4;}
  to{opacity:0.9;}
}

/* SOL */
.sunGlow{
  background:radial-gradient(circle at 80% 20%,
    rgba(255,255,0,0.6),
    transparent 60%);
}

/* NEBLINA */
.fog{
  backdrop-filter:blur(6px);
  background:rgba(255,255,255,0.06);
}

/* CONTRASTE AUTOMÁTICO */
body.clima-sol .aviso-card,
body.clima-parcial .aviso-card{
  color:#000;
}
body.clima-noite .aviso-card,
body.clima-chuva .aviso-card,
body.clima-tempestade .aviso-card{
  color:#fff;
}

.wrapper{
  position:relative;
  z-index:2;
  min-height:100vh;
  padding:14px;
  display:grid;
  grid-template-rows:auto 1fr auto;
  gap:12px;
}

/* HEADER */
.header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  background:linear-gradient(90deg,#0b223a,#10375d);
  padding:18px 22px;
  border-radius:22px;
}

.header h1{
  margin:0;
  font-size:28px;
  font-weight:900;
}

.badge{
  padding:8px 14px;
  border-radius:999px;
  background:#0f3e63;
  font-weight:700;
}

/* AVISOS */
.avisos{
  display:grid;
  grid-template-rows:repeat(3, 1fr);
  gap:12px;
}

.aviso-card{
  border-radius:20px;
  padding:18px 20px;
  display:flex;
  flex-direction:column;
  justify-content:space-between;
  animation:fade .6s ease;
}

@keyframes fade{
  from{opacity:0; transform:translateY(8px);}
  to{opacity:1; transform:translateY(0);}
}

/* CORES */
.prioridade-alta{
  background:linear-gradient(180deg,#b71c1c,#e53935);
}
.prioridade-media{
  background:linear-gradient(180deg,#f9a825,#ffeb3b);
  color:#000;
}
.prioridade-baixa{
  background:linear-gradient(180deg,#2e7d32,#66bb6a);
}

/* RESTANTE DO SEU LAYOUT PERMANECE IGUAL */
/* ... mantive simplificado para foco nos efeitos ... */

</style>
</head>

<body>

<div id="weatherEffects"></div>

<div class="wrapper">

<div class="header">
  <div style="display:flex;align-items:center;gap:16px;">
    <h1>Comunica Síndico - Condôminos</h1>
  </div>
  <span class="badge" id="clock">--:--</span>
</div>

<div class="avisos" id="avisosContainer"></div>

</div>

<script>
/* RELÓGIO */
function tick(){
  const d=new Date();
  document.getElementById("clock").textContent=
    d.toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"});
}
setInterval(tick,1000); tick();

/* CLIMA COM EFEITOS */
async function carregarClima(){
  try{
    const rJson = await fetch("./data.json?ts="+Date.now());
    const json = await rJson.json();

    const lat = json.clima?.latitude || -28.4667;
    const lon = json.clima?.longitude || -49.0069;

    const r = await fetch(
      `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current_weather=true`
    );

    const d = await r.json();
    const w = d.current_weather;
    const codigo = w.weathercode;
    const hora = new Date().getHours();

    const effects = document.getElementById("weatherEffects");
    effects.className="";

    document.body.classList.remove(
      "clima-sol","clima-parcial","clima-nublado",
      "clima-chuva","clima-tempestade","clima-noite"
    );

    if(hora >= 18 || hora <= 5){
      document.body.classList.add("clima-noite");
      effects.classList.add("stars");
    }
    else{
      if(codigo === 0){
        document.body.classList.add("clima-sol");
        effects.classList.add("sunGlow");
      }
      else if(codigo <= 3){
        document.body.classList.add("clima-parcial");
        effects.classList.add("fog");
      }
      else if(codigo < 60){
        document.body.classList.add("clima-nublado");
        effects.classList.add("fog");
      }
      else if(codigo < 80){
        document.body.classList.add("clima-chuva");
        effects.classList.add("rain");
      }
      else{
        document.body.classList.add("clima-tempestade");
        effects.classList.add("rain");
      }
    }

  }catch(e){
    console.error("Erro clima:",e);
  }
}

carregarClima();
setInterval(carregarClima,600000);
</script>

</body>
</html>
